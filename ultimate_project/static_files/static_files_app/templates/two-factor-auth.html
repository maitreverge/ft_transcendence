{% load static %}

<!-- ! PONG BACKGROUND  -->
<div class="pong-background" id="pong-background"></div>

<div class="container" data-page-type="two_factor_auth" id="two_factor_auth_container">
	<div class="class_custom mb-4 mx-auto">
		<div class="card shadow mb-4 background-color-form">
			<div class="card-body background-color-form text-center">
				<h1 class="h1 text-gray-900 font-weight-bold text-uppercase">Verify your account</h1>

				<!-- ! FORM TO VERIFY THE CODE -->
				<form hx-post="/auth/verify-2fa/" id="two_factor_auth_form" hx-target="#login_error" hx-swap="outerHTML"
					hx-headers='{"HX-Request": "true"}' hx-indicator="#loading-spinner">
					<div class="form-group">
						<div class="h4 font-bold">Enter the code given by your authenticator app:
							<div />
							<input id="otp_input" type="number" name="token" maxlength="6"
								class="form-control form-control-user" placeholder="Enter 6-digit code" required />
							<input type="hidden" id="username" name="username" value="{{ username }}" />
						</div>
						<div class="small text-info mb-3"></div>
						<div class="form-group mt-4">
							<button id="otp_verify" type="submit" class="btn btn-primary btn-user btn-block">
								Verify and Login
							</button>

							<!-- ! BUTTON TO GO BACK TO LOGIN PAGE -->
							<a href="/login/" class="btn btn-secondary btn-user btn-block mt-2" id="cancel_button"
								hx-get="/login/" hx-target="body" hx-swap="outerHTML" hx-push-url="true"
								hx-headers='{"HX-Request": "true"}'>
								Cancel
							</a>
						</div>
				</form>

				<!-- Error message container -->
				<div id="login_error" class="text-center text-danger mt-2"></div>

				<!-- Loading spinner -->
				<div id="loading-spinner" class="htmx-indicator text-center my-2">
					<div class="spinner-border text-primary" role="status">
						<span class="sr-only">Loading...</span>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script src="{% static 'static_files/js/two-fa-module.js' %}"></script>
<script>
	initPongAnimation(false);
</script>
